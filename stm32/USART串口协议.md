# USART串口协议

## 简介

**通信接口：**

- 通信的目的：将一个设备的数据传送到另一个设备，扩展硬件系统
- 通信协议：制定通信的规则，通信双方按照协议规则进行数据收发

![image-20240907140911523](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240907140911523.png)



**串口通信：**

- 串口是一种应用十分广泛的通讯接口，串口成本低、容易使用、通信线路简单，可实现两个设备的互相通信
- 单片机的串口可以使单片机与单片机、单片机与电脑、单片机与各式各样模块互相通信，极大地拓展了单片机的应用范围，增强了单片机系统的硬件实力

![image-20240907141916858](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240907141916858.png)



**硬件电路：**

- 简单双向串口通信有两根通信线（发送端TX和接收端RX）
- TX与RX要交叉连接
- 当只需单向的数据传输时，可以只接一根通信线
- 当电平标准不一致时，需要加电平转换芯片

![image-20240907141900324](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240907141900324.png)



**电平标准：**

​	电平标准是数据1和数据0的表达方式，时传输线缆中人为规定的电压与数据的对应关系，串口常用的电平标准有如下三种：

1. **TTL电平**：+3.3V或+5V表示1，0V表示0 （单片机中最常见）
2. **RS232电平**：-3~-15V表示1，+3~+15V表示0
3. **RS485电平**：两线压差+2~+6V表示1，-2~-6V表示0（**差分信号**）



**串口参数及时序**：

- 波特率：串口通信的速率
- 起始位：标志一个数据帧的开始，固定为低电平
- 数据为：数据帧的有效载荷，1为高电平，0为低电平，低位先行
- 校验位：用于数据验证，根据数据位计算得来
- 停止位：用于数据帧间隔，固定为高电平

![image-20240907142820168](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240907142820168.png)



**USART简介**：

- USART(Universal Synchronous/Asynchronous Receiver/Transmitter)通用同步/异步收发器
- USART是STM32内部集成的硬件外设，可根据数据寄存器的一个字节数据自动生成数据帧时序，从TX引脚发送出去，也可以自动接收RX引脚的数据帧时序，拼接为一个字节数据，存放在数据寄存器里
- 自带波特发生器，最高达4.5Mbits/s
- 可配置数据位长度(8/9)、停止位长度(0.5/1/1.5/2)
- 可选校验位（无校验/奇校验/偶校验）
- 支持同步模式、硬件流控制、DMA、智能卡、IrDA、LIN
- STM32F103C8T6 USART资源：USART1、USART2、USART3

**数据模式**：

- **HEX模式/十六进制模式/二进制模式**：以原始数据的形式显示
- **文本模式/字符模式**：以原始数据编码后的形式显示

![image-20240908184118080](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240908184118080.png)



**USART框图**：

![image-20240907144745889](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240907144745889.png)



**USART基本结构图**：

![image-20240907145530919](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240907145530919.png)

## 项目实现

### 串口发送

#### 接线图

![image-20240908180609236](https://picgo-1301260628.cos.ap-guangzhou.myqcloud.com/image-20240908180609236.png)

